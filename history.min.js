/*!
 * History API JavaScript Library v4.0.7
 *
 * Support: IE6+, FF3+, Opera 9+, Safari, Chrome and other
 *
 * Copyright 2011-2013, Dmitrii Pakhtinov ( spb.piksel@gmail.com )
 *
 * http://spb-piksel.ru/
 *
 * Dual licensed under the MIT and GPL licenses:
 *   http://www.opensource.org/licenses/mit-license.php
 *   http://www.gnu.org/licenses/gpl.html
 *
 * Update: 2013-10-30 18:29
 */
(function(f){var i=!0,k=null,n=!1;function J(){}function l(a,b,c){if(a&&!b)var b=l(),c=b.e,e=b.h,a=/^(?:[\w0-9]+\:)?\/\//.test(a)?0===a.indexOf("/")?e+a:a:e+"//"+b.g+(0===a.indexOf("/")?a:0===a.indexOf("?")?c+a:0===a.indexOf("#")?c+b.f+a:c.replace(/[^\/]+$/g,"")+a);else if(a=b?a:d.href,!o||c)a=a.replace(/^[^#]*/,"")||"#",a=d.protocol+"//"+d.host+j.basepath+a.replace(RegExp("^#[/]?(?:"+j.type+")?"),"");O.href=a;var a=/(?:([\w0-9]+:))?(?:\/\/(?:[^@]*@)?([^\/:\?#]+)(?::([0-9]+))?)?([^\?#]*)(?:(\?[^#]+)|\?)?(?:(#.*))?/.exec(O.href),b=
a[2]+(a[3]?":"+a[3]:""),c=a[4]||"/",e=a[5]||"",f="#"===a[6]?"":a[6]||"",g=c+e+f,t=c.replace(RegExp("^"+j.basepath,"i"),j.type)+e;return{a:a[1]+"//"+b+g,h:a[1],g:b,i:a[2],k:a[3]||"",e:c,f:e,b:f,c:g,j:t,d:t+f}}function Z(){var a="";if(B)a+=B.getItem(E);else{var b=g.cookie.split(E+"=");1<b.length&&(a+=b.pop().split(";").shift()||"null")}try{p=q.parse(a)||{}}catch(c){p={}}u(v+"unload",function(){if(B)B.setItem(E,q.stringify(p));else{var a={};if(a[d.href]=h.state)g.cookie=E+"="+q.stringify(a)}},n)}function w(a,
b,c,e){var c=c||{set:J},d=!c.set,g=!c.get,t={configurable:i,set:function(){d=1},get:function(){g=1}};try{C(a,b,t),a[b]=a[b],C(a,b,c)}catch(fa){}if(!d||!g)if(a.__defineGetter__&&(a.__defineGetter__(b,t.get),a.__defineSetter__(b,t.set),a[b]=a[b],c.get&&a.__defineGetter__(b,c.get),c.set&&a.__defineSetter__(b,c.set)),(!d||!g)&&a===f){try{var $=a[b];a[b]=k}catch(ga){}if("execScript"in f)f.execScript("Public "+b,"VBScript");else try{C(a,b,{value:J})}catch(l){}a[b]=$}else if(!d||!g)try{try{var x=F.create(a);
C(F.getPrototypeOf(x)===a?x:a,b,c);for(var h in a)"function"===typeof a[h]&&(x[h]=a[h].bind(a));try{e.call(x,x,a)}catch(j){}a=x}catch(m){C(a.constructor.prototype,b,c)}}catch(o){return n}return a}function aa(a,b,c){c=c||{};a=a===K?d:a;c.set=c.set||function(c){a[b]=c};c.get=c.get||function(){return a[b]};return c}function G(a,b){var c=(""+("string"===typeof a?a:a.type)).replace(/^on/,""),e=y[c];if(e){b="string"===typeof a?b:a;if(b.target==k)for(var d=["target","currentTarget","srcElement","type"];a=
d.pop();)b=w(b,a,{get:"type"===a?function(){return c}:function(){return f}});(("popstate"===c?f.onpopstate:f.onhashchange)||J).call(f,b);for(var d=0,g=e.length;d<g;d++)e[d].call(f,b);return i}return ba(a,b)}function P(){var a=g.createEvent?g.createEvent("Event"):g.createEventObject();a.initEvent?a.initEvent("popstate",n,n):a.type="popstate";a.state=h.state;G(a)}function r(a,b,c,e){o||(b=l(b),b.c!==l().c&&(z=e,c?d.replace("#"+b.d):d.hash=b.d));!H&&a&&(p[d.href]=a);D=n}function L(a){if(z){Q!==d.href&&
P();var a=a||f.event,b=l(z,i),c=l();a.oldURL||(a.oldURL=b.a,a.newURL=c.a);b.b!==c.b&&G(a)}z=d.href}function R(a){setTimeout(function(){u("popstate",function(a){Q=d.href;H||(a=w(a,"state",{get:function(){return h.state}}));G(a)},n)},0);!o&&a!==i&&h.location&&(S(h.location.hash),D&&(D=n,P()))}function ca(a){var a=a||f.event,b;a:{for(b=a.target||a.srcElement;b;){if("A"===b.nodeName)break a;b=b.parentNode}b=void 0}var c="defaultPrevented"in a?a.defaultPrevented:a.returnValue===n;b&&"A"===b.nodeName&&
!c&&(c=l(),b=l(b.getAttribute("href",2)),c.a.split("#").shift()===b.a.split("#").shift()&&b.b&&(c.b!==b.b&&(h.location.hash=b.b),S(b.b),a.preventDefault?a.preventDefault():a.returnValue=n))}function S(a){var b=g.getElementById(a=(a||"").replace(/^#/,""));b&&b.id===a&&"A"===b.nodeName&&(a=b.getBoundingClientRect(),f.scrollTo(I.scrollLeft||0,a.top+(I.scrollTop||0)-(I.clientTop||0)))}function da(){function a(a){var b=[],e="VBHistoryClass"+(new Date).getTime()+c++,d=["Class "+e],g;for(g in a)if(a.hasOwnProperty(g)){var h=
a[g];h&&(h.get||h.set)?(h.get&&d.push("Public "+("_"===g?"Default ":"")+"Property Get ["+g+"]","Call VBCVal([(accessors)].["+g+"].get.call(me),["+g+"])","End Property"),h.set&&d.push("Public Property Let ["+g+"](val)",h="Call [(accessors)].["+g+"].set.call(me,val)\nEnd Property","Public Property Set ["+g+"](val)",h)):(b.push(g),d.push("Public ["+g+"]"))}d.push("Private [(accessors)]","Private Sub Class_Initialize()","Set [(accessors)]="+e+"FactoryJS()","End Sub","End Class","Function "+e+"Factory()",
"Set "+e+"Factory=New "+e,"End Function");f.execScript(d.join("\n"),"VBScript");f[e+"FactoryJS"]=function(){return a};e=f[e+"Factory"]();for(d=0;d<b.length;d++)e[b[d]]=a[b[d]];return e}function b(a){var b=/[\\"\u0000-\u001f\u007f-\u009f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,c={"\u0008":"\\b","\t":"\\t","\n":"\\n","\u000c":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};return b.test(a)?'"'+a.replace(b,function(a){return a in c?c[a]:"\\u"+("0000"+
a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}var c=f.eval&&eval("/*@cc_on 1;@*/");if(c&&!(7<+(/msie (\d+)/i.exec(navigator.userAgent)||[,8])[1])){var e=w,A=l().a,j=g.createElement("iframe");j.src="javascript:true;";j=I.firstChild.appendChild(j).contentWindow;f.execScript("Public history\nFunction VBCVal(o,r) If IsObject(o) Then Set r=o Else r=o End If End Function","VBScript");s={_:{get:K.toString}};h={back:m.back,forward:m.forward,go:m.go,emulate:k,_:{get:function(){return"[object History]"}}};
q={parse:function(a){try{return(new Function("","return "+a))()}catch(b){return k}},stringify:function(a){var c=(typeof a).charCodeAt(2);if(114===c)a=b(a);else if(109===c)a=isFinite(a)?""+a:"null";else if(111===c||108===c)a=""+a;else if(106===c)if(a){var e=(c="[object Array]"===F.prototype.toString.call(a))?"[":"{";if(c)for(var d=0;d<a.length;d++)e+=(0==d?"":",")+q.stringify(a[d]);else for(d in a)a.hasOwnProperty(d)&&(e+=(1==e.length?"":",")+b(d)+":"+q.stringify(a[d]));a=e+(c?"]":"}")}else a="null";
else a="void 0";return a}};r=function(a,b,c,e,f){var g=j.document,b=l(b);D=n;if(b.c===l().c&&!f)a&&(p[d.href]=a);else{z=e;if(c)j.lfirst?(history.back(),r(a,b.a,0,e,1)):d.replace("#"+b.d);else if(b.a!=A||f)j.lfirst||(j.lfirst=1,r(a,A,0,e,1)),g.open(),g.write('<script>lfirst=1;parent.location.hash="'+b.d.replace(/"/g,'\\"')+'";<\/script>'),g.close();!f&&a&&(p[d.href]=a)}};w=function(b,c,d,g){e.apply(this,arguments)||(b===s?s[c]=d:b===h?(h[c]=d,"state"===c&&(s=a(s),f.history=h=a(h))):b[c]=d.get&&d.get());
return b};setInterval(function(){var a=l().a;if(a!=A){var b=g.createEventObject();b.oldURL=A;b.newURL=A=a;b.type="hashchange";L(b)}},100);f.JSON=q}}if(f.history){var g=f.document,I=g.documentElement,B=k,F=f.Object,q=f.JSON,d=f.location,m=f.history,h=m,M=m.pushState,T=m.replaceState,o=!!M,H="state"in m,C=F.defineProperty,s=w({},"t")?{}:g.createElement("a"),v="",N=f.addEventListener?"addEventListener":(v="on")&&"attachEvent",U=f.removeEventListener?"removeEventListener":"detachEvent",V=f.dispatchEvent?
"dispatchEvent":"fireEvent",u=f[N],W=f[U],ba=f[V],j={basepath:"/",redirect:0,type:"/"},E="__historyAPI__",O=g.createElement("a"),z=d.href,Q="",D=n,p={},y={},ea={onhashchange:k,onpopstate:k},X=function(a,b){var c=f.history!==m;c&&(f.history=m);a.apply(m,b);c&&(f.history=h)},Y={redirect:function(a,b){j.basepath=b=b==k?j.basepath:b;j.type=a=a==k?j.type:a;if(f.top==f.self){var c=l(k,n,i).c,e=d.pathname+d.search;o?(e=e.replace(/([^\/])$/,"$1/"),c!=b&&RegExp("^"+b+"$","i").test(e)&&d.replace(c)):e!=b&&
(e=e.replace(/([^\/])\?/,"$1/?"),RegExp("^"+b,"i").test(e)&&d.replace(b+"#"+e.replace(RegExp("^"+b,"i"),a)+d.hash))}},pushState:function(a,b,c){var e=g.title;b!=k&&(g.title=b);M&&X(M,arguments);r(a,c);g.title=e},replaceState:function(a,b,c){var e=g.title;b!=k&&(g.title=b);delete p[d.href];T&&X(T,arguments);r(a,c,i);g.title=e},location:{set:function(a){f.location=a},get:function(){return o?d:s}},state:{get:function(){return p[d.href]||k}}},K={assign:function(a){0===(""+a).indexOf("#")?r(k,a):d.assign(a)},
reload:function(){d.reload()},replace:function(a){0===(""+a).indexOf("#")?r(k,a,i):d.replace(a)},toString:function(){return this.href},href:{get:function(){return l().a}},protocol:k,host:k,hostname:k,port:k,pathname:{get:function(){return l().e}},search:{get:function(){return l().f}},hash:{set:function(a){r(k,(""+a).replace(/^(#|)/,"#"),n,z)},get:function(){return l().b}}};(function(){var a=g.getElementsByTagName("script"),a=(a[a.length-1]||{}).src||"";(-1!==a.indexOf("?")?a.split("?").pop():"").replace(/(\w+)(?:=([^&]*))?/g,
function(a,b,c){j[b]=(c||("basepath"===b?"/":"")).replace(/^(0|false)$/,"")});try{B=f.sessionStorage}catch(b){}da();u(v+"hashchange",L,n);var c=[K,s,ea,f,Y,h];H&&delete Y.state;for(var e=0;e<c.length;e+=2)for(var d in c[e])if(c[e].hasOwnProperty(d))if("function"===typeof c[e][d])c[e+1][d]=c[e][d];else{a=aa(c[e],d,c[e][d]);if(!w(c[e+1],d,a,function(a,b){if(b===h)f.history=h=c[e+1]=a}))return W(v+"hashchange",L,n),n;c[e+1]===f&&(y[d]=y[d.substr(2)]=[])}j.redirect&&h.redirect();!H&&q&&Z();if(!o)g[N](v+
"click",ca,n);"complete"===g.readyState?R(i):(!o&&l().c!==j.basepath&&(D=i),u(v+"load",R,n));return i})()&&(h.emulate=!o,f[N]=function(a,b,c){a in y?y[a].push(b):3<arguments.length?u(a,b,c,arguments[3]):u(a,b,c)},f[U]=function(a,b,c){var d=y[a];if(d)for(a=d.length;--a;){if(d[a]===b){d.splice(a,1);break}}else W(a,b,c)},f[V]=G)}})(window);
